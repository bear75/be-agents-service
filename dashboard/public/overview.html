<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Agent Service</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .dashboard-container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 20px;
    }

    .nav-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding: 20px 30px;
      background: var(--glass-white);
      backdrop-filter: blur(var(--glass-blur)) saturate(180%);
      border: 2px solid var(--glass-border);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-lg);
    }

    .nav-header h1 {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-weight: 800;
    }

    .nav-links {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .nav-link {
      padding: 10px 20px;
      background: rgba(102, 126, 234, 0.1);
      border: 2px solid rgba(102, 126, 234, 0.2);
      border-radius: 8px;
      color: var(--text-primary);
      text-decoration: none;
      font-weight: 600;
      transition: all 0.2s;
    }

    .nav-link:hover {
      background: rgba(102, 126, 234, 0.2);
      transform: translateY(-2px);
    }

    .nav-link.active {
      background: #667eea;
      color: white;
      border-color: #667eea;
    }

    .section-title {
      font-size: 24px;
      font-weight: 700;
      margin: 40px 0 20px;
      color: var(--text-primary);
    }

    .quick-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .quick-stat {
      background: var(--glass-light);
      border: 2px solid var(--glass-border);
      border-radius: var(--border-radius);
      padding: 20px;
      text-align: center;
    }

    .quick-stat .value {
      font-size: 28px;
      font-weight: 800;
      color: var(--text-primary);
    }

    .quick-stat .label {
      font-size: 12px;
      color: var(--text-secondary);
      margin-top: 4px;
      text-transform: uppercase;
    }
  </style>
</head>
<body>
  <div class="dashboard-container">
    <div class="nav-header">
      <h1 style="margin: 0;"><a href="/overview.html" style="color: inherit; text-decoration: none;">üìä Dashboard</a></h1>
      <div class="nav-links">
        <a href="/" class="nav-link">Workspace</a>
        <a href="/overview.html" class="nav-link active">Sessions</a>
        <a href="/management-team.html" class="nav-link">Management (4)</a>
        <a href="/engineering.html" class="nav-link">Engineering (10)</a>
        <a href="/sales-marketing.html" class="nav-link">Sales & Marketing (10)</a>
        <a href="/rl-dashboard.html" class="nav-link">RL</a>
        <a href="/kanban.html" class="nav-link">üìã Task Board</a>
        <a href="/commands.html" class="nav-link">Docs</a>
        <a href="/settings.html" class="nav-link">‚öôÔ∏è Settings</a>
      </div>
    </div>

    <h2 class="section-title">Overview</h2>
    <div class="quick-stats" id="quick-stats">
      <div class="quick-stat">
        <div class="value" id="total-agents">‚Äî</div>
        <div class="label">Total Agents</div>
      </div>
      <div class="quick-stat">
        <div class="value" id="eng-count">10</div>
        <div class="label">Engineering</div>
      </div>
      <div class="quick-stat">
        <div class="value" id="mkt-count">10</div>
        <div class="label">Sales & Marketing</div>
      </div>
      <div class="quick-stat">
        <div class="value" id="mgmt-count">4</div>
        <div class="label">Management</div>
      </div>
      <div class="quick-stat">
        <div class="value" id="active-sessions">‚Äî</div>
        <div class="label">Active Sessions</div>
      </div>
    </div>

    <p class="section-desc" style="color: var(--text-secondary); margin-top: 0;">
      Use the navigation bar above to switch between Workspace, Sessions, Engineering, Kanban, Docs, and Settings.
    </p>
  </div>

  <script>
    async function loadOverview() {
      try {
        const [perfRes, sessionsRes] = await Promise.all([
          fetch('/api/rl/agent-performance'),
          fetch('/api/sessions').catch(() => ({ json: () => [] }))
        ]);

        const agents = perfRes.ok ? await perfRes.json() : [];
        const sessions = sessionsRes.ok ? await sessionsRes.json() : [];

        const eng = agents.filter(a => a.team === 'Engineering');
        const mkt = agents.filter(a => a.team === 'Marketing');
        const mgmt = agents.filter(a => a.team !== 'Engineering' && a.team !== 'Marketing');
        const activeSessions = (sessions || []).filter(s => ['pending', 'in_progress'].includes(s.status));

        document.getElementById('total-agents').textContent = agents.length || '‚Äî';
        document.getElementById('eng-count').textContent = eng.length || 10;
        document.getElementById('mkt-count').textContent = mkt.length || 10;
        document.getElementById('mgmt-count').textContent = mgmt.length || 4;
        document.getElementById('active-sessions').textContent = activeSessions.length;
      } catch (e) {
        console.error('Error loading overview:', e);
      }
    }

    loadOverview();
    setInterval(loadOverview, 15000);
  </script>
</body>
</html>
